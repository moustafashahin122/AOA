clear all
clc

Networks;


%==========================================================================
%case 1 DGs at unity power factor
%==========================================================================

%
%
% caps_locations =
%
%      []
%
%
% caps_sizes =
%
%      []
%
%
% caps_tot_size =
%
%      0
%
%
% DGs_locations =
%
%     23    31
%
%
% DGs_sizes =
%
%    1.0e+03 *
%
%     1.8475    1.1525
%
%
% DGs_tot_size =
%
%    3.0000e+03
%
%
% V_min =
%
%     0.9832
%at bus 27
%
% V_max =
%
%      1
%
%
% Total_PLoss =
%
%    74.4167
%
%
% Total_QLoss =
%
%    21.4547
%
%
% over_all_power_factor =
%
%     0.4949
%
%
case_1_v=[ 1.0000
    0.9972
    0.9949
    0.9922
    0.9901
    0.9884
    0.9877
    0.9877
    0.9883
    0.9892
    0.9887
    0.9886
    0.9946
    0.9943
    0.9942
    0.9942
    0.9869
    0.9858
    0.9851
    0.9848
    0.9850
    0.9859
    0.9874
    0.9850
    0.9838
    0.9834
    0.9832
    0.9874
    0.9872
    0.9870
    0.9903
    0.9900
    0.9898
    0.9898];
case_1_conv=[84.5908
    84.5908
    79.5434
    79.5434
    79.5434
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    78.4056
    75.6999
    75.6398
    75.4762
    75.3587
    75.0833
    75.0111
    74.7715
    74.7715
    74.5458
    74.5458
    74.5217
    74.5217
    74.4581
    74.4472
    74.4472
    74.4472
    74.4472
    74.4472
    74.4287
    74.4287
    74.4287
    74.4287
    74.4287
    74.4287
    74.4287
    74.4241
    74.4241
    74.4241
    74.4238
    74.4207
    74.4168
    74.4168
    74.4167
    74.4167];
%
%
% min_conv =
%
%    74.4167
%
%
% Total_PLoss =
%
%    74.4167
%

%==========================================================================
%case 2 DGs at .9 power factor
%==========================================================================

% 
% caps_locations =
% 
%      []
% 
% 
% caps_sizes =
% 
%      []
% 
% 
% caps_tot_size =
% 
%      0
% 
% 
% DGs_locations =
% 
%     23    10
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     1.8633    1.1367
% 
% 
% DGs_tot_size =
% 
%    3.0000e+03
% 
% 
% V_min =
% 
%     0.9888
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%    25.3482
% 
% 
% Total_QLoss =
% 
%     7.2488
% 
% 
% over_all_power_factor =
% 
%     0.7552
% 
% 
case_2_v=[    1.0000
    0.9978
    0.9961
    0.9940
    0.9925
    0.9913
    0.9908
    0.9909
    0.9917
    0.9927
    0.9923
    0.9922
    0.9958
    0.9955
    0.9954
    0.9954
    0.9902
    0.9895
    0.9892
    0.9893
    0.9898
    0.9911
    0.9929
    0.9905
    0.9894
    0.9889
    0.9888
    0.9905
    0.9903
    0.9901
    0.9924
    0.9921
    0.9919
    0.9919];

case_2_conv=[40.8167
   38.3478
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   35.4106
   30.3332
   28.4387
   27.2173
   26.3704
   25.7611
   25.6643
   25.6450
   25.5861
   25.5861
   25.5861
   25.5861
   25.5861
   25.5861
   25.5861
   25.5861
   25.5861
   25.4012
   25.3572
   25.3524
   25.3524
   25.3524
   25.3524
   25.3524
   25.3524
   25.3524
   25.3524
   25.3513
   25.3484
   25.3484
   25.3484
   25.3484
   25.3484
   25.3484
   25.3482
   25.3482];

%==========================================================================
%case 3 caps only
%==========================================================================



% 
% caps_locations =
% 
%     18     9    24
% 
% 
% caps_sizes =
% 
%   896.8852  758.8628  826.7559
% 
% 
% caps_tot_size =
% 
%    2.4825e+03
% 
% 
% DGs_locations =
% 
%      []
% 
% 
% DGs_sizes =
% 
%      []
% 
% 
% DGs_tot_size =
% 
%      0
% 
% 
% V_min =
% 
%     0.9503
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%   160.4252
% 
% 
% Total_QLoss =
% 
%    46.9588
% 
% 
% over_all_power_factor =
% 
%     0.9965


    case_3_conv =[163.0971
  163.0971
  163.0971
  163.0971
  163.0971
  163.0155
  163.0155
  163.0155
  163.0155
  163.0155
  163.0155
  163.0155
  163.0155
  163.0155
  163.0155
  161.7396
  160.5222
  160.4586
  160.4463
  160.4463
  160.4463
  160.4460
  160.4402
  160.4351
  160.4287
  160.4287
  160.4287
  160.4287
  160.4258
  160.4258
  160.4254
  160.4254
  160.4254
  160.4254
  160.4253
  160.4253
  160.4253
  160.4253
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252
  160.4252];
case_3_v =[1.0000
    0.9952
    0.9910
    0.9851
    0.9800
    0.9753
    0.9719
    0.9700
    0.9679
    0.9667
    0.9663
    0.9661
    0.9907
    0.9904
    0.9903
    0.9903
    0.9716
    0.9686
    0.9649
    0.9620
    0.9594
    0.9565
    0.9542
    0.9521
    0.9509
    0.9504
    0.9503
    0.9715
    0.9713
    0.9712
    0.9664
    0.9660
    0.9659
    0.9658];

%==========================================================================
%case 5 DG pf .9 and caps only
%==========================================================================

% caps_locations =
% 
%      8
% 
% 
% caps_sizes =
% 
%   365.5680
% 
% 
% caps_tot_size =
% 
%   365.5680
% 
% 
% DGs_locations =
% 
%     31    24    21
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     0.7993    0.9465    1.2542
% 
% 
% DGs_tot_size =
% 
%    3.0000e+03
% 
% 
% V_min =
% 
%     0.9900
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%    17.1153
% 
% 
% Total_QLoss =
% 
%     5.1227
% 
% 
% over_all_power_factor =
% 
%     0.8405
% 
% 
% min_conv =
% 
%    17.1153


   case_5_conv =[47.2543
   42.8637
   36.3463
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   29.5129
   28.5959
   26.7972
   23.2162
   19.4361
   18.7785
   18.4267
   18.4267
   18.0107
   18.0107
   18.0107
   17.7425
   17.5452
   17.4163
   17.3353
   17.2522
   17.2522
   17.2522
   17.2522
   17.2522
   17.2096
   17.2096
   17.2096
   17.1522
   17.1522
   17.1522
   17.1463
   17.1463
   17.1463
   17.1288
   17.1234
   17.1193
   17.1178
   17.1159
   17.1153
   17.1153];


   case_5_v =[1.0000
    0.9980
    0.9964
    0.9945
    0.9931
    0.9920
    0.9907
    0.9903
    0.9902
    0.9905
    0.9901
    0.9900
    0.9961
    0.9958
    0.9957
    0.9957
    0.9915
    0.9913
    0.9917
    0.9924
    0.9935
    0.9926
    0.9923
    0.9926
    0.9914
    0.9910
    0.9908
    0.9904
    0.9902
    0.9901
    0.9913
    0.9910
    0.9908
    0.9908];



%==========================================================================
%case 4 DG unity and caps 
%==========================================================================
% caps_locations =
% 
%      7    24
% 
% 
% caps_sizes =
% 
%    1.0e+03 *
% 
%     1.1104    0.8166
% 
% 
% caps_tot_size =
% 
%    1.9270e+03
% 
% 
% DGs_locations =
% 
%      9    21    25
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     0.9528    1.1255    0.9216
% 
% 
% DGs_tot_size =
% 
%    3.0000e+03
% 
% 
% V_min =
% 
%     0.9892
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%    18.1505
% 
% 
% Total_QLoss =
% 
%     5.2471
% 
% 
% over_all_power_factor =
% 
%     0.8656
% 
% 
% min_conv =
% 
%    18.1505


   case_4_conv =[   69.6833
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   67.7847
   43.1062
   36.7933
   33.2432
   31.0322
   28.8483
   26.1611
   24.7089
   24.5446
   23.8707
   22.6750
   22.1292
   22.0558
   21.1527
   20.8878
   20.7892
   20.6430
   20.5020
   20.1687
   19.6238
   19.2520
   19.1160
   18.7462
   18.6628
   18.5333
   18.5123
   18.3901
   18.3272
   18.2957
   18.2227
   18.1776
   18.1617
   18.1535
   18.1514
   18.1505
   18.1505];


case_4_v =[1.0000
    0.9980
    0.9965
    0.9946
    0.9932
    0.9922
    0.9915
    0.9911
    0.9912
    0.9900
    0.9896
    0.9895
    0.9961
    0.9958
    0.9957
    0.9957
    0.9913
    0.9909
    0.9908
    0.9912
    0.9920
    0.9912
    0.9910
    0.9914
    0.9918
    0.9914
    0.9912
    0.9911
    0.9909
    0.9908
    0.9897
    0.9894
    0.9892
    0.9892];


%==========================================================================
%==========================================================================
%==========================================================================
%==========================================================================


case_0=[ 1
    0.99414
    0.98902
    0.98205
    0.97606
    0.97041
    0.96659
    0.96448
    0.96201
    0.96083
    0.96037
    0.96023
    0.98869
    0.98838
    0.9883
    0.98829
    0.96595
    0.96224
    0.95815
    0.95485
    0.95199
    0.94872
    0.94603
    0.94351
    0.9423
    0.94183
    0.94169
    0.96625
    0.96603
    0.96591
    0.96049
    0.96015
    0.95998
    0.95992];









x=1:IEEE_34.Nb;
w=1:50;
for i=1:IEEE_34.Nb;
    y(i)=.95;
end


for i=1:34;
    y(i)=.95;
end
figure(1)
plot(x,case_0,'-or',x,case_1_v,'-b^',x,case_2_v,'-m^',x,case_3_v,'-^g',x,case_4_v,'-^',x,case_5_v,'-^',x,y,'k--')
legend('case 0','case 1','case 2','case 3','case 4','case 5','minimum voltage')
title('34 Bus')
xlabel('Bus')
ylabel('voltage P.U.')
temp1=['voltage profile','.png'];
saveas(gca,temp1);
figure(2)
plot(w,case_2_conv,'-m^',w,case_1_conv,'-^g',w,case_4_conv,'-^',w,case_5_conv,'-^')
legend('case 2','case 1','case 4','case 5')
title('convergence curve')
xlabel('Bus')
ylabel('Total Power loss')
temp1=['convergence curve 4 cases','.png'];
saveas(gca,temp1);
figure(3)
plot(w,case_3_conv,'-b^')
legend('case 3')
title('convergence curve')
xlabel('Bus')
ylabel('Total Power loss')
temp1=['convergence curve cap','.png'];
saveas(gca,temp1);