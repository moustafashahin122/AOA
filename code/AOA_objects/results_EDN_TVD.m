clear all
clc

Networks;


%==========================================================================
%case 1 DGs at unity power factor
%==========================================================================

% caps_locations =
% 
%      []
% 
% 
% caps_sizes =
% 
%      []
% 
% 
% caps_tot_size =
% 
%      0
% 
% 
% DGs_locations =
% 
%     26    29
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     1.9999    2.0000
% 
% 
% kvar =
% 
%      0     0
% 
% 
% DGs_tot_size =
% 
%    3.9999e+03
% 
% 
% V_min =
% 
%     0.9677
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%   572.0918
% 
% 
% Total_QLoss =
% 
%   259.9298
% 
% 
% TVD =
% 
%     0.0193
% 
% 
% over_all_power_factor =
% 
%     0.7932
% 
% 
% min_conv =
% 
%     0.0193


case_1_conv =[

    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0236
    0.0233
    0.0229
    0.0224
    0.0222
    0.0218
    0.0210
    0.0204
    0.0203
    0.0203
    0.0197
    0.0195
    0.0194
    0.0194
    0.0194
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193
    0.0193];


case_1_v =[

    1.0000
    0.9874
    0.9826
    0.9816
    0.9792
    0.9773
    0.9759
    0.9755
    0.9742
    0.9739
    0.9737
    0.9736
    0.9736
    0.9807
    0.9746
    0.9727
    0.9722
    0.9686
    0.9683
    0.9679
    0.9677
    0.9679
    0.9685
    0.9697
    0.9746
    0.9753
    0.9756
    0.9758
    0.9785
    0.9785];

% 
% minee =
% 
%     0.9677
% 
% 
% minbus =
% 
%     21


%==========================================================================
%case 2 DGs at .9 power factor
%==========================================================================

% 
% 
% caps_locations =
% 
%      []
% 
% 
% caps_sizes =
% 
%      []
% 
% 
% caps_tot_size =
% 
%      0
% 
% 
% DGs_locations =
% 
%     28    28
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     1.9997    1.9993
% 
% 
% kvar =
% 
%   968.5071  968.3085
% 
% 
% DGs_tot_size =
% 
%    3.9990e+03
% 
% 
% V_min =
% 
%     0.9703
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%   491.1647
% 
% 
% Total_QLoss =
% 
%   225.4215
% 
% 
% TVD =
% 
%     0.0163
% 
% 
% over_all_power_factor =
% 
%     0.8335
% 
% 
% min_conv =
% 
%     0.0163


case_2_conv =[

    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0227
    0.0225
    0.0223
    0.0217
    0.0214
    0.0212
    0.0204
    0.0202
    0.0197
    0.0191
    0.0176
    0.0175
    0.0175
    0.0174
    0.0172
    0.0171
    0.0169
    0.0167
    0.0166
    0.0165
    0.0164
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163
    0.0163];


case_2_v =[

    1.0000
    0.9879
    0.9832
    0.9821
    0.9797
    0.9779
    0.9765
    0.9761
    0.9748
    0.9744
    0.9743
    0.9741
    0.9741
    0.9817
    0.9760
    0.9743
    0.9738
    0.9708
    0.9706
    0.9703
    0.9704
    0.9709
    0.9719
    0.9734
    0.9797
    0.9805
    0.9814
    0.9819
    0.9817
    0.9817];

% 
% minee =
% 
%     0.9703
% 
% 
% minbus =
% 
%     20



%==========================================================================
%case 3 caps only
%==========================================================================


% caps_locations =
% 
%     25    26    29    29
% 
% 
% caps_sizes =
% 
%    1.0e+03 *
% 
%     0.4415    1.1983    1.1948    1.1654
% 
% 
% caps_tot_size =
% 
%    4.0000e+03
% 
% 
% DGs_locations =
% 
%      []
% 
% 
% DGs_sizes =
% 
%      []
% 
% 
% kvar =
% 
%      []
% 
% 
% DGs_tot_size =
% 
%      0
% 
% 
% V_min =
% 
%     0.9572
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%   712.8063
% 
% 
% Total_QLoss =
% 
%   317.9989
% 
% 
% TVD =
% 
%     0.0326
% 
% 
% over_all_power_factor =
% 
%     0.9108
% 
% 
% min_conv =
% 
%     0.0326


case_3_conv =[

    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0347
    0.0346
    0.0342
    0.0341
    0.0340
    0.0340
    0.0338
    0.0338
    0.0334
    0.0334
    0.0331
    0.0330
    0.0329
    0.0329
    0.0329
    0.0329
    0.0328
    0.0328
    0.0328
    0.0328
    0.0328
    0.0328
    0.0327
    0.0327
    0.0327
    0.0327
    0.0327
    0.0327
    0.0327
    0.0326
    0.0326
    0.0326
    0.0326
    0.0326
    0.0326
    0.0326];


case_3_v =[

    1.0000
    0.9865
    0.9817
    0.9807
    0.9782
    0.9764
    0.9750
    0.9746
    0.9733
    0.9729
    0.9728
    0.9727
    0.9727
    0.9784
    0.9706
    0.9682
    0.9674
    0.9617
    0.9612
    0.9602
    0.9590
    0.9581
    0.9575
    0.9572
    0.9573
    0.9573
    0.9574
    0.9575
    0.9585
    0.9584];


% minee =
% 
%     0.9572
% 
% 
% minbus =
% 
%     24

%==========================================================================
%case 4 DG unity and caps 
%==========================================================================

% caps_locations =
% 
%      9    27
% 
% 
% caps_sizes =
% 
%   839.8649  467.4556
% 
% 
% caps_tot_size =
% 
%    1.3073e+03
% 
% 
% DGs_locations =
% 
%     29    29    27
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     1.1436    1.2210    1.6353
% 
% 
% kvar =
% 
%      0     0     0
% 
% 
% DGs_tot_size =
% 
%    3.9999e+03
% 
% 
% V_min =
% 
%     0.9686
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%   531.6377
% 
% 
% Total_QLoss =
% 
%   241.7645
% 
% 
% TVD =
% 
%     0.0177
% 
% 
% over_all_power_factor =
% 
%     0.8204
% 
% 
% min_conv =
% 
%     0.0177


case_4_conv =[

    0.0221
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0201
    0.0179
    0.0179
    0.0178
    0.0178
    0.0178
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177
    0.0177];


case_4_v =[

    1.0000
    0.9877
    0.9832
    0.9822
    0.9799
    0.9782
    0.9770
    0.9766
    0.9755
    0.9752
    0.9751
    0.9749
    0.9749
    0.9812
    0.9751
    0.9733
    0.9728
    0.9693
    0.9691
    0.9687
    0.9686
    0.9689
    0.9696
    0.9708
    0.9761
    0.9768
    0.9776
    0.9778
    0.9810
    0.9810];


% minee =
% 
%     0.9686
% 
% 
% minbus =
% 
%     21

%==========================================================================
%case 5 DG pf .9 and caps only
%==========================================================================

% caps_locations =
% 
%      7    24
% 
% 
% caps_sizes =
% 
%   419.1310  382.5831
% 
% 
% caps_tot_size =
% 
%   801.7141
% 
% 
% DGs_locations =
% 
%     23    25    29
% 
% 
% DGs_sizes =
% 
%    1.0e+03 *
% 
%     0.7303    1.0266    2.0000
% 
% 
% kvar =
% 
%   353.7221  497.2087  968.6201
% 
% 
% DGs_tot_size =
% 
%    3.7569e+03
% 
% 
% V_min =
% 
%     0.9701
% 
% 
% V_max =
% 
%      1
% 
% 
% Total_PLoss =
% 
%   469.8317
% 
% 
% Total_QLoss =
% 
%   216.9197
% 
% 
% TVD =
% 
%     0.0170
% 
% 
% over_all_power_factor =
% 
%     0.8508
% 
% 
% min_conv =
% 
%     0.0170
% 

case_5_conv =[

    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0198
    0.0194
    0.0193
    0.0193
    0.0191
    0.0191
    0.0191
    0.0188
    0.0188
    0.0188
    0.0183
    0.0182
    0.0179
    0.0178
    0.0176
    0.0174
    0.0173
    0.0173
    0.0173
    0.0173
    0.0173
    0.0173
    0.0173
    0.0172
    0.0172
    0.0171
    0.0171
    0.0171
    0.0170
    0.0170
    0.0170
    0.0170
    0.0170
    0.0170
    0.0170
    0.0170];


case_5_v =[

    1.0000
    0.9880
    0.9833
    0.9823
    0.9800
    0.9782
    0.9769
    0.9765
    0.9752
    0.9748
    0.9747
    0.9745
    0.9745
    0.9817
    0.9759
    0.9742
    0.9737
    0.9706
    0.9703
    0.9701
    0.9701
    0.9706
    0.9714
    0.9724
    0.9766
    0.9769
    0.9773
    0.9775
    0.9806
    0.9806];

% 
% minee =
% 
%     0.9701
% 
% 
% minbus =
% 
%     20

%==========================================================================
%==========================================================================
%==========================================================================
%==========================================================================


case_0=EDN.voltages








x=1:EDN.Nb;
w=1:50;
for i=1:EDN.Nb;
    y(i)=.95;
end


for i=1:EDN.Nb;
    y(i)=.95;
end
figure(1)
plot(x,case_0,'-or',x,case_1_v,'-b^',x,case_2_v,'-m^',x,case_3_v,'-^g',x,case_4_v,'-^',x,case_5_v,'-^',x,y,'k--')
legend('case 0','case 1','case 2','case 3','case 4','case 5','minimum voltage')
title('EDN')
xlabel('Bus')
ylabel('voltage P.U.')
temp1=['voltage profile','.png'];
saveas(gca,temp1);
figure(2)
plot(w,case_2_conv,'-m^',w,case_1_conv,'-^g',w,case_4_conv,'-^',w,case_5_conv,'-^')
legend('case 2','case 1','case 4','case 5')
title('convergence curve')
xlabel('Bus')
ylabel('TVD')
temp1=['convergence curve 4 cases','.png'];
saveas(gca,temp1);
figure(3)
plot(w,case_3_conv,'-b^')
legend('case 3')
title('convergence curve')
xlabel('Bus')
ylabel('TVD')
temp1=['convergence curve cap','.png'];
saveas(gca,temp1);